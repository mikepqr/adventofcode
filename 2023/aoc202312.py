import itertools
import re

BROKEN = re.compile(r"#+")
ONE_UNKNOWN = re.compile(r"\?")
ONE_BROKEN = re.compile(r"#")


def parse_line(line: str) -> tuple[str, list[int]]:
    split_line = line.split()
    row = split_line[0]
    runs = [int(s) for s in split_line[1].split(",")]
    return row, runs


def check_row(row: str, true_runs: list[int]) -> bool:
    """
    Relatively slow approach to checking whether a row is consistent with runs
    using a regex.

    Returns False as soon as an invalid run is found.
    """
    return all(
        (run.end() - run.start()) == true_run
        for run, true_run in zip(BROKEN.finditer(row), true_runs)
    )


def check_positions(positions: list[int], true_runs: list[int]) -> bool:
    """
    Faster approach to checking whether a row is consistent with runs that takes
    the positions of broken sprinklers rather than the entire row.

    Returns False as soon as an invalid run is found.
    """

    positions = positions[:]
    true_runs = true_runs[:]

    run = 1
    x = positions.pop()
    true_run = true_runs.pop()

    while positions:
        y = positions.pop()
        if x - 1 == y:
            # Extend the run
            run += 1
            if run > true_run:
                return False
        else:
            # Complete the run. Check if its length is expected.
            if run == true_run:
                run = 1
                true_run = true_runs.pop()
            else:
                return False
        x = y
    return True


def count_possible_rows(row: str, runs: list[int]) -> int:
    n_broken = sum(runs)

    unknown_positions = [match.start() for match in ONE_UNKNOWN.finditer(row)]
    known_positions = [match.start() for match in ONE_BROKEN.finditer(row)]
    n_missing = n_broken - len(known_positions)

    print(len(unknown_positions), n_missing)
    return sum(
        check_positions(sorted(known_positions + list(trial_positions)), runs)
        for trial_positions in itertools.combinations(unknown_positions, n_missing)
    )


def part1():
    n_possible = 0
    for line in data:
        row, runs = parse_line(line)
        n = count_possible_rows(row, runs)
        n_possible += n
    return n_possible


def part2():
    n_possible = 0
    for i, line in enumerate(data):
        row, runs = parse_line(line)
        row = "?".join([row] * 5)
        runs = runs * 5
        n = count_possible_rows(row, runs)
        n_possible += n
        print(i, n)
    return n_possible


data = """
???.### 1,1,3
????.#...#... 4,1,1
????.######..#####. 1,6,5
?#?#?#?#?#?#?#? 1,3,1,6
.??..??...?##. 1,1,3
?###???????? 3,2,1
""".strip().splitlines()

# data = """
# ..?????#?? 4,1
# #?..??.???##?.?? 2,1,1,3,1
# ?#?.#.??#.?#?#????? 1,1,1,9
# ??#?#?#??????#??? 9,5
# .?#??????. 1,3
# #??????.??.??? 4,1,1,1
# ?.????##??.?#???. 2,3
# ???#????#???.? 4,3,1
# ???#??..?#?.. 5,1
# ?.?.???..??.? 1,1,3,1
# ???????#???? 4,1,2,1
# ??.??????????#??? 3,2
# ##???##???????????# 9,1,5
# ????##???? 1,5
# ?????.????#?. 3,5
# ?.??????#???? 1,6
# ??.#?#??????##?.. 2,4,3
# ..???#?#???????????. 7,1
# ?????#???.#??????#? 7,5,2
# ??#??.??#? 1,2,4
# ???????#?# 2,5
# .#?.????????#??.? 2,4,4
# ?#?????????#?.?? 8,1,1
# ??#?#????.????#?? 6,1,1,1,1
# ??.??##?.????? 1,5,2
# ???#??#.??????. 4,2,1,4
# ?#?####...? 6,1
# ?????.???#?.?. 3,3
# ??.?#?.?????#?????? 2,8
# .???##???? 4,2
# .???#??###????.? 3,8
# ??#??..??#? 4,3
# #?.#?..#??## 2,1,1,2
# ?????#.#???.??#??? 1,1,1,1,4,1
# ##????.??#?#??#??.? 2,1,8
# ?.#?#???#. 3,1
# ???.???????.??? 1,7,1,1
# ??#?.??#?.? 1,3
# ???.??.????##???? 1,2,7,1
# ????#????#??#?? 1,2,6
# ???..###??????.#? 2,5,1,1
# ??##??.???.???.?? 4,2,3,1
# ????#???#.????. 7,1
# ???.??#??.?#?????? 3,2
# .???#.?##..? 4,2
# ?...???#?#. 4,1
# .????#?##????? 7,2
# ?#???#???##??#??? 1,9,3
# #?#?????#?????.?.? 1,1,6,1,1
# #????#???#?.???? 7,1,2,1
# .????.?#?. 3,2
# ??..?.??.?.??. 1,1,1
# ?????#??#.?#. 1,5,1
# ??#.??#????.? 3,3,1,1
# ????????????? 2,1
# ??.???#?#?#????#?? 1,7,1,3
# #?##???????????? 1,2,3,1,2
# ##?##??????.????. 5,1,1,1,1
# ???#.????? 2,1,2
# .????###?.??#?????? 5,1,1
# ?#.?#???#??##??.?..# 1,1,9,1,1
# #??????#???#? 2,6,2
# ?.?##.?.#? 3,2
# .???#????? 4,1,2
# ?????.?.??. 1,1,1
# ?????#????#????? 3,1,7
# ?#?###..#???##?????? 6,1,3,3
# ?.????##?? 2,2
# ????#??##???#????? 3,7,1,1
# ??.#?#.?###??.. 2,1,1,3
# ?..#?#????? 4,1
# ?????#??..????##??. 6,7
# ##???.#??.?? 2,1,1,2
# ?##?#.?#?#?.?.?. 5,1,1,1,1
# .??.?#?.?#? 2,1
# ?????.????#???#?.?. 1,8,1
# #?###????#?.?.. 1,4,1,1,1
# .??#???##???#.??# 2,1,3,1,1
# .???.?#?#????.? 2,7
# .?.??#.??.???????? 1,1,2,1,3,1
# #???#??#??? 3,2,3
# #?.??.???##?? 2,1,3
# .##??????.??????#?.# 2,1,1,4,1,1
# ???#??#?.??#??#??.#. 5,1,4,1
# .??.???????#? 1,1,2,2
# ??###??.??.?#?? 7,1,4
# ??.???????? 1,8
# ??#??##???#.??? 10,2
# #.??#???..???#??# 1,1,1,1,5
# #?.??#??.?..?? 1,4,1,1
# ?.??..?#.???#?#?#. 2,1,6
# ????#?#??#??... 6,3
# ?#?#?????#?##.?#? 6,2,2,1
# ?#??.???????????. 3,3,6
# .#.??#?#??.?#.?#?. 1,4,1,2,2
# ???#???.???.?#?#?#?. 4,7
# ???#?????#?.???.?. 2,3,1,1,1,1
# ?#?.#??#??? 1,6
# ??.?????#????.??..? 1,10,1
# ?.?#?##.??#??.?. 1,4,1,2,1
# ??.#??.???? 3,1,1
# ?????##?.###?#???? 5,7
# ?#?#??.???#??.???.? 5,1,3,1,1
# ??#???##??##??#. 1,13
# ?##????.?#???? 4,1,6
# .???????????????? 7,6
# .?#???#?#??.# 5,1,1
# ?.??????.?#??.????? 5,3,2
# ??#???.#??#...?.? 4,4
# ????.????? 3,3
# ????#???#??.? 1,1,2,1
# ??.??????##?#??##.? 1,7,1,3
# #???##?..? 1,3
# ????????#????.#? 1,1,3,3,1
# ??????????#???#????? 1,2,2,1,1,5
# .?.???##????#?????? 1,7,1,1,1
# ???????.??#??#??? 2,1,2,4
# ???????#??.??.??#? 1,3,1,1,1,4
# ???#.????#???#?? 1,1,4,1,1
# ?????#?##? 1,3
# ..?#?????#??.??..? 2,2,1
# ????????????..?? 5,1,1,1
# ???????##????#? 1,1,5,2
# ????#????? 1,1,2
# ?#???#..??.#??.? 4,1,1,1,1
# ?.?#.?..?#?#?? 1,2,4,1
# ??#?##??#?##??.??##. 1,12,3
# ?.??#?#?.?.?????#? 1,6,1,4
# ??????#?????? 1,1,6,1
# ???..??#??#?????? 1,9,1
# #????#???? 3,1,2
# ????.?.????.?? 1,1,1
# .?##?#?##??###?? 8,5
# ?#???.?????#??# 3,4,4
# ??#??#.???#? 6,1,1
# #???.?#??##..?? 3,6
# ??????????#?? 3,2,2
# ????#?????#?? 1,2,1,2
# .?#?#???###?. 5,5
# ?##??????.?? 5,1,2
# ????????#?##?##?.# 3,1,1,5,1
# ???#?????#??#??#??? 4,10
# ?#?????#????#?##??? 9,6
# ??.?.????????.#?. 4,1
# ?#??#????#?#???. 10,2
# ??.??????? 1,1
# .??.????.????..? 3,4
# .???..????..???.. 3,2
# ?.#?????..???#??. 6,1
# ???.??#?#? 1,5
# ??????#?#????#.?? 1,7,1,1
# #??#?##.??????#??? 2,4,4,3
# ?.??.#???#?? 1,3,1
# ??.???????#?? 1,10
# ???.#?#?..#??#? 1,3,2,1
# .?.?##???.? 1,5
# ??###?#?#?.??#????? 8,7
# ?#?..???#???? 2,7
# ?#?##????????? 4,2,3
# ?.?#?#?????.? 1,3,1
# ?????.??##??????? 1,1,6,2
# ?#..#???.?.?#.???? 1,4,1,1,1,1
# ?#..???.????? 1,3,1,1
# ?.??#????????? 1,1,3,1
# ?#?#..?????. 3,2
# ?#?###?#?#????# 10,2
# ?.??#.?#??? 2,2
# ??#?.#?#?..???# 1,1,3,2
# ?#.????????.??????? 1,3,1,1,1,2
# ???.????#?.?##??.#. 1,1,2,5,1
# ??..#???#. 1,1,1
# ?.????#??????????? 1,2,1,1,1,2
# .?#...??##. 1,1,2
# ?.?????##. 1,2,3
# ?.#?#?##?#?##.?# 1,4,4,1
# ?##.?????.? 3,1,1
# ????#??.?#?.?????? 7,3,3,1
# ??#?#??.?????.???#? 6,1,2,4
# ??##???????#?? 6,1,3
# ..????.????#??#??? 2,7
# ???????#??.#?#??#. 1,1,1,1,4,1
# ???#???????? 1,1,2,1
# ????.?????? 3,2
# ???#??.???? 4,1
# ??#.??????.?.????#?. 2,1,2,1,5
# ????.#?.??..#???? 2,2,2,3
# .????.??.?#?##?#? 1,1,2,8
# ??.?#.?????#?. 2,7
# .?#.?##???..?..?? 1,5
# ????.##?#????. 1,5,2
# ?.??????###??#??.? 1,1,8,1
# ???.???...? 1,2,1
# .#.????.?.?????? 1,2,3,1
# ?#?????###??#???. 1,12
# ?????????.? 4,1
# ??.?????.????? 1,5,1
# .??.??.???? 1,1
# .???????.?? 2,1,1
# ??.##?.??.?#?..??### 2,3,2,5
# ????#??????#?#??.? 4,8,1,1
# ????#..????# 1,2,3,1
# ??##..#?.?#?##. 3,2,2,2
# ??#####?#????? 7,3
# ?.?.?##?## 1,5
# ?..??.??..???#? 2,4
# ???#???##?????#. 8,2
# ?#.#????#? 1,1,2
# ??.?##???.? 1,4,1
# ?..??#?#??.#???? 7,3
# ?.??#.???????#??... 1,1,2,7
# ?#???.????#??..??? 2,2,1,4,1,1
# ?#?..???.???????? 1,5
# ??.?#?#??#?#??.?#?. 1,11,3
# ##???#????.?#???.? 4,1,2,4
# .??#?.?????#?. 4,2,2
# .##??????????#?..? 2,5
# .???.?##?????#??#? 3,7,1,1
# ?##???#??????? 3,7
# ?.??.???#?? 1,6
# .??.?#????#??#??#? 1,2,9
# .????#???##.###?? 9,3
# ...??#??#???????? 4,1,1,1,2
# ?????##?##??? 3,6
# #?????#???##????. 4,2,4,1
# ??????.#??#. 1,1,4
# ##???????#####??.?? 2,8,2
# ???#??????. 2,3
# ???#.?#.??#??# 3,1,2,1
# ???#????.????? 1,2,2,5
# ??.?.??.??? 1,1,2
# .##?#.??#..? 4,2,1
# .??????.??###? 1,6
# ???????##.???. 6,2,2
# ?????????.? 1,2
# ?##?????.?? 6,1
# ?????.???.?. 1,3
# .?#??.??.???##.?. 3,1,1,2,1
# ????.??#??.?#??? 1,1,4,1,1
# .??#???.#??.????? 1,2,3
# ?????????#?????.?# 1,6,2,1
# ?#???..??????### 5,1,6
# ????..??## 1,2,3
# ?#??.?##??#?#?. 2,8
# ?#?????#?.????? 6,2,1,1
# #.#.???#??#. 1,1,4,2
# #####?#?##?#?#??#??. 5,8,1
# ?????????#???##???? 1,1,3,1,4,1
# ????.????#?##???.? 1,8
# .?##???????? 3,2
# #??.?..#????.? 1,1,1,3
# ?.??#?????????# 1,1,2,1,5
# .#??????????.????. 5,3,4
# .??.#?.????????????? 1,1,1,5,1,1
# ?#?#.?????. 1,1,5
# #?????#??#?##????# 1,4,4,1,1
# ????..?#??? 3,1
# .?#.?.???? 1,1
# ??.????.??? 2,3,1
# ?##????#??#??????.?? 3,6,1,2,1
# ?.?#?.#?#?#??#??? 2,11
# ??.#?.#???#???? 1,1,8
# ?#???.#??#? 2,1,1
# ????#?.??###. 1,1,5
# #?????#??..??????? 1,6,6
# ??????#??#??.??#.? 8,1
# ??????#??????? 10,1
# ??.????????#?? 2,2,1
# ?#?.?#?.?##?# 2,1,5
# #??????.#.?????? 4,2,1,1,2
# ?.????????#??????? 2,9,1
# ?..##???.??###? 4,5
# .???#??.##?# 3,4
# ?#..?##?.?..? 1,4
# #?????.?.??# 1,4,1
# .??.???#??#??? 1,5,1,1
# ????#??..?.#??#? 1,4,1,1,1
# .?#??#?##.#?.???? 1,2,2,2,2
# .?#?.?##????# 3,4,3
# .?#???#.#???.??#? 5,1,3
# .#.?#??.#. 1,2,1
# ??#?????.? 6,1
# ??.??#?????#???? 1,6,3
# ?#?#.?.??#??#.?? 4,3,2,1
# ...?#????. 2,1
# ?.#?.???#?#??? 1,1,8
# .??##?#???#??.##. 1,6,1,1,2
# ???#?##???.##??.? 2,2,2,4
# ???????##??? 4,4
# .#??????.? 6,1
# ?.?#?????.?.?? 6,1
# ???#????#?? 4,4
# #??###.#.?? 6,1,1
# ??.??.??.#?#? 2,1,1,1
# ?#???????.????.#? 8,1,1,1
# .#?.??.?#?.?. 1,2,2
# .??#????#??#?. 2,2,3
# ?#.?#??..???.#??. 1,2,2,3
# ????.???#??...?? 1,1,3,2
# ?..?????.???? 1,2,1
# .??????????????. 2,6
# ???.?###??#?##.?. 1,1,10
# .??#????.?##.?. 4,3
# ##?..?.??????? 3,1,3,1
# ???????#??.?????#?? 1,7,2,1
# ??.?.?#?#??# 1,1,3,1
# .?#.?.?..?##?#??.? 1,1,4
# ?.?#????#. 2,2,1
# ??????.#?? 1,1,1
# ????#..????????## 2,1,1,5,2
# ???.?.???#?#???# 2,1,6,2
# ??#??...???? 4,1,1
# ?#?.?????# 2,2,3
# .??.?????.. 2,2
# ???????????????? 5,1
# .?.?#?????#???# 1,2,1,2,3
# .??.#.???#?.??? 1,1,2,2,1
# ??#????????.??.????? 1,7,1,3
# ??#?????#??. 5,2
# ????..??.#????? 1,2,2,6
# ??#.?????## 1,6
# #?##?#?????? 8,1
# .?#??#????#? 2,1,2
# #?#???.??# 5,1
# ?????????#???#??.?? 2,9,1
# ?????.#?.??????? 5,1,1,1,1
# .?#???????. 1,6
# ??.??.?.??? 1,2,1
# .??..?##?.??..### 1,3,1,3
# ?????#?#???.?.?. 8,1,1
# ..#???.???? 3,3
# ?#??#?#??##? 2,2,1,3
# ???????#??..?. 1,6,1
# ???##???????# 6,1,2
# ??#??.?#?.????##??? 1,1,1,1,3,5
# ?..?#..??##??#? 1,2,8
# ??????#..???????. 1,4,3,1,1
# ??#?.?????. 2,5
# ???#.????#???#???? 1,1,1,7,1
# ??#??#???.#?????? 3,1,1,1,2
# ?#?????.?.#? 4,1,1
# #??#?#??#?.#. 1,7,1
# ??..#?#?..??? 3,1
# .????#??#?#??.???. 11,1
# ???##????#.??#.??? 1,7,3
# ?#??#????????#.??? 1,2,1,1,1,3
# ????#??#?# 3,1,3
# ?.?#?###???.??? 2,5,2
# ?#?#???????? 4,1
# #?#???????#? 1,4,1,2
# ???#?.#?????# 1,2,4,2
# .##????????#?#?. 3,1,1,3
# #??????.?? 5,1,1
# ?##.????.???# 3,1,1,1
# ???.??###???#??#???? 3,10,4
# ?????##.?#?#?#??.?. 2,3,7,1
# ??.????????##??.?.?? 1,11,1,1
# ?.?????#??????? 1,1
# ????##??????#?????#. 1,14,1
# ##???.???#?#?? 3,4
# ?#??##..???#? 3,2,1
# ????.??.???? 1,2,1,1
# ???###?????.?.??? 1,8,2
# #?#?#???..#.??????? 5,1,1,1,1,1
# ??????????.??? 5,4,2
# ?..????.##???? 1,2
# ???????#???? 2,2,1,2
# ???#.???#???.?. 3,1,2,1
# ???#????#?? 4,4
# ?.????.?#?#? 2,3
# ????????#.?#??..?# 1,4,1,1,2
# .#?.???.????#?.??? 2,3,1,2,1
# ?????????.?#?#??.? 1,4,3,1,1
# ????#?#????#??? 1,2,1,5
# .?.#?.#??.##? 1,2,3,2
# ?.??##????.??#??#??. 8,6
# ???#?#??????#??#?# 8,3,4
# ??.??????# 1,6
# ?..????#????##?.#??? 1,1,9,4
# ..??##.?##??? 3,6
# ?????####??.??#. 1,1,6,1,1
# #??#.#???? 4,1,1
# #?????.???. 2,2,2
# .?.##???.??# 3,2
# ?#??????.? 3,2
# ???#??.??? 1,1,2
# ??.??#???.???? 1,4,1,1
# ???###?.#?.?? 4,1
# ?????#????## 1,1,1,2
# ..?#?????#? 2,4
# #??#???#??..????? 1,6,1,1,1
# ??#???.?.? 3,1
# ?????.???? 2,1,1
# ????..?????? 1,4
# .??????#????.##?## 8,5
# ??????#??# 4,1,1
# ?.????.?#??##?## 2,9
# ?#???#??.#?????????? 8,1,1,1,1,1
# ??????.????#?? 3,2,2
# ?###...?#??#.? 3,4
# ?????.?#.? 1,1,1
# ?????.?????????#???? 4,1,1,1,1,2
# ?????#?.????? 7,4
# ????#.???#.??### 3,2,4
# .??##???????????.? 1,6,1,1,1,1
# ?.#??..?#????.# 2,5,1
# .?.?.?#.???#?#. 1,1,1,3,1
# ??????????????#? 2,5,4
# #.?#.??.??### 1,1,2,5
# ??#???.??? 1,3,1
# .?###?#?.?.?.##???#? 3,1,6
# ??????#?#???#.? 2,5,1,1
# ????###?.?#???.?#?? 8,1,2,1
# .?.?#?#??.#??.??? 4,1,2
# ???????#??? 2,7
# #??#?#???? 7,1
# ?.???.??.. 1,2,1
# .????###?????????. 7,1,1,2
# #???.??#.?#? 1,2,2,3
# ##??.???.????##.?#?? 4,1,1,1,3,3
# .#??????#?##???? 1,1,4,2,1
# ???????##??#?.??.? 2,1,3,2,2,1
# ?????###???..??. 7,2
# #???#.????###.???? 2,1,7,2,1
# ???.?.?????#..#? 1,1,1,3,1
# #?????#?????#????? 1,1,4,2,2
# ????????.??##..? 1,3,2,3,1
# ?.??#?#?#??##??#?#. 1,6,3,1,1
# ?.?#?#??.##? 3,1,2
# ??#???##.?? 1,2,2
# ?????#??##????? 1,9
# ???###?#????.?##?#. 1,10,4
# .?..?#??#??.#??? 1,6,1,1
# ?...?#.??? 1,1,1
# .#??#???###????#?#. 1,7,1,3
# ?#???????# 2,2,3
# .???#?..#????# 3,1,4
# ????????????#.? 1,2,5
# .?#????##. 2,2
# #???#..#????#??? 5,3,2
# .#???#???###?##?# 1,12
# ????????#?# 4,4
# #????#?.????#.?# 4,2,5,1
# ?###?.#????#????# 5,8,1
# #?#?#??#???? 1,3,1,1
# ??.?#?.?#?????#???? 2,3,4,1,2,1
# #???..???.#???## 2,1,1,1,6
# ?.?..#.???##???? 1,1,1,5,1
# ?.#.??.#.# 1,1,1
# .?.???###?#?? 1,8
# ?????????#.?????? 8,2
# .#?.??##.????.?? 1,4,3,1
# .????###..?.#? 7,1
# #?##??.????. 6,4
# ??#????#.?#????.??#. 6,1,1,1,1,1
# ????#?.??#???.??? 2,3,5,1
# ?????...?. 5,1
# ?????#?.??????.# 2,1,2,1
# .#?#????#??.???????? 1,1,4,1,3,1
# ?????..?.???. 1,1,1,3
# ?????????.?.???#. 7,3
# ???????.#? 6,2
# #??##?????.?.?.??# 2,5,1,1,2
# ??#?#?????? 4,1
# ?????.#..#. 4,1,1
# ???????#?...?.?# 1,5,1,1
# ..????#??? 5,1
# #?#???#?#??.?? 1,5,3,1
# ?.#???#??#??###?##?# 1,2,2,2,8
# ?????????.#???? 4,1,1,1,1
# .??????????#?#??? 1,3,5,2
# .??..#????#???#. 1,1,2,5
# ?????#??####????? 3,9
# ?????????##????? 2,10
# ?#?.##????.#????#? 1,2,2,4,2
# ?#?..??.?#?#.. 3,1,3
# ???###.##????? 1,3,4,1
# ?#.?.?#?##???#??? 1,1,8
# ?.??#.?.?.????????? 2,2
# ??#??##??.???## 2,3,1,1,3
# ????#???##????? 10,3
# ?.#?.?.????#?..?.#?. 1,1,1,6,1,1
# ???.?##?????.???#?# 1,1,4,1,1,3
# ??#?????????? 2,4,3
# ???????#???????#?#?# 1,1,3,7,1,1
# ??????...?#??.?. 5,3,1
# ?#?????????.???### 2,3,1,5
# ...?..?..#?#?.? 1,1,4
# ?.#?.?????..? 1,1,1,1
# ?#.?.????#.????????? 1,1,1,3,6,2
# ????#?##.?.??..? 1,5,1,2
# .???#??.?#??????? 4,4
# ?#????#??.?? 4,1,1
# ?.??.?.##? 1,3
# ??#??#???.?????##. 7,6
# ??##.#?#?#?#. 4,7
# ??##??#?..?#?.#?? 5,2,1
# ?#??.??#??.????.??#? 4,1,1,1,1,4
# ???#?.??????????. 5,10
# ???##??#??##? 4,5
# .???.???.?# 1,3,2
# ?????#???#????.?? 3,2,1,1,1
# ?.??##??????.?.??#? 1,7,1,1,1,1
# ???#??##?#???.?? 9,1
# ???#????##??#???##?# 1,3,6,2,1
# ???#?#?#????.?..?### 10,4
# ??##???#??????## 2,2,1,2,2
# #?.#?????..?? 1,4,1
# ??#?..###???#?#. 3,7,1
# ?.#???###???..?? 1,2,6,1
# ??##.???#?????#???? 4,1,11
# ?????#??????.?##?. 4,2,1,1,3
# #??#??.????? 1,1,1,1
# .??#??.??#?????? 3,1,7
# .##??.#?.??.????? 4,2,1,1,1
# ?#.???.?#?? 2,3,1
# ?.??#?????.? 3,3
# ??#??#?##??# 2,8
# .?.##??###??????.?? 1,7,2,1,1
# .#????????????##?#?? 3,13
# .??..???##???????#.. 2,1,8,1
# ??????????? 3,2
# ????#?.????#.#??? 1,1,5,2
# ?????.????????. 1,1
# ?#??????.? 2,1
# ???#?##??#? 7,1
# #??????#.??#??.?.#? 1,5,2,1,1
# ??#???????.??? 5,1,1
# ?????#?????.????? 9,1,2
# ##????####.??? 10,2
# ?.#..??????#?? 1,6
# .#??#??##?????? 1,6,1
# ..?#?.???#?????? 3,1,3,1,1
# ??.#??.?????? 2,1,1,5
# ?#?#????#?..#????? 9,1,4
# ...????###?..???.?? 7,1
# ?#?.??#???#??????? 1,9
# ###??##?.?..??? 8,1
# .##?.????? 3,1,1
# .#????.??##?? 3,1,4
# .??.#.?.??. 2,1,1
# .???.?#???#? 3,2,4
# ??..??#?????.?#??.. 6,1
# #??#.#.?????#?# 4,1,1,5
# .#?????##?. 1,1,3
# #????#.??.?.?????? 3,1,1,1,1,2
# ?.?????.#?#?.?. 1,3,1,2
# ??????.?#?#? 2,1,1,1
# .??????#.?#.???? 6,1,1
# ?.??#?...??????.? 3,5
# ?#?##????????##??. 9,1,2,1
# #?????????.? 1,1,1,1
# .????.?????# 1,1,2,1
# ?#?#.???????.. 4,6
# .????#..?##??? 3,4
# ?.??#?#???????????? 1,1,1,5,1,1
# ??#.?????..?#.#?? 3,3,1,2
# ??##..?.????? 4,2
# ????????????? 4,3,1,1
# ?##???????##???##?#? 6,1,10
# ?????.??#?#??? 3,5
# #..??..#.? 1,1,1
# ???..??#???.?## 2,2,1,3
# ?????.#??????? 2,4,1
# #.?????????#??# 1,2,2,2
# .????????.?.?.??##. 6,2
# ??????.???. 1,2
# ?.?????#???.? 5,1
# ..??..??#???? 1,4
# ??##???..?.??? 6,1
# ?????.?#??#???##. 2,5,3
# ??.??????????????? 3,8
# ?#.?#??#?? 2,5
# ..???.???#? 3,1,1
# ...?#.??.? 2,2
# ?###?#?.?#.?.??#???? 6,2,1,1,2
# .?#?.???#???.?##???? 2,4,1,3,1
# ?#??#??###?.?..???# 6,4,1,4
# ?##?#????#??.?.? 9,1,1,1
# #???#?.#.#.?#.??.?? 5,1,1,1,1,1
# ?#??#???.### 1,4,3
# ??.??????#??#????# 1,2,1,5,1,1
# ?.?#?#??###.??# 9,2
# ??##?????#.?? 9,2
# ??.??????#?. 1,3,1
# .?#?.??????? 1,2,1,1
# ?.?#?.?.?.##.??? 2,2
# #?#???.????#.? 5,4
# ?????.????#? 3,1,1
# ?.??#???#??..???? 8,1
# ?..???.??????#????? 1,2,4
# ?.??.?#??????#???##? 2,1,3
# ..?..??????.???# 3,1,4
# ????.#?#?? 1,1,1
# ?#??.?????? 1,1,3
# ?#?.??..?#????#????? 2,10
# ..#??#??##??#???. 1,6,4
# .#????##??#??? 1,9
# .?.???.??????#? 1,1,6
# ???????????.?##.??? 6,1,3,2
# ?#?#???.????????#?#. 1,3,1,1,6
# ??##?.???#?.????#..? 3,5,4,1
# ??#??.?#??????#??# 1,1,1,1,1,7
# #???.?#????#?..#?# 4,8,1,1
# ???#?#???#.???##.# 5,1,1,2,1
# ??????.??????.??. 3,5,1
# ????#????.#???? 4,1
# ?.##?##.???#?#?? 5,6
# ?????#?.???? 1,1,3,2
# .?????#?#? 1,5
# ????#???###.??##.? 10,2,1
# ??#?##.??#???.????# 2,2,1,4,1,1
# ?#???.#####??? 1,1,5,1
# ????..???. 2,2
# ?.????#??# 2,2,1
# ????#???#????.?#. 6,1
# ?.???????? 1,1,2
# ?##???????????..??? 6,3
# .???#??#???#??#?.## 6,4,2
# ?????#????#?#?#??? 6,9
# ?#..????#?#? 1,2,3
# ?.????????? 1,2
# ??#..?#?##.??#?.? 3,2,2,1,1
# #??.???#?.????? 2,1,2,3
# ??#???.??.?.??? 3,1,1,1,1
# ???????.#??? 4,1,1,2
# ???????#?????#. 4,4,2
# .#??#?.#.??? 1,1,1,2
# ?#???..????.?.?#?? 2,4,2
# ##???????##?# 2,3,5
# ???#?????? 1,2
# ?#.##???#???#????? 1,3,1,4,1
# ???...??##?#? 2,4,1
# ?.?##???#.?? 3,2,1
# ?????#.??? 2,1
# #?#???#????#???#.?## 1,1,12,2
# ???.??#?????????#### 2,6,7
# .?..??###?#??.?. 1,1,6,1
# .?.???.????#??# 1,7
# #?##??????? 1,5
# ...##.?#??????? 2,7
# ???????###?.??#????. 11,6
# ?????#?##???????? 4,9
# #?#??????#..?#?.#?? 10,2,2
# ?.##????##?#??????.? 2,8
# #?#...#.?#????###?? 3,1,1,1,4
# ?#.?#????.?? 2,2,1,1
# ?.??#?##??? 6,1
# .??#????..? 6,1
# ?.?##.???????#.? 2,1
# ??#???????#.? 2,4,1
# ??#??###..?..?? 6,1,1
# ??????????#.? 3,3
# ?????##??????. 8,1
# #?##???#????# 1,4,3,1
# .????????????#?????? 4,8
# ?#?????????? 1,3,1,1
# .?#?.#???.??? 3,1,2,1
# #????#??.????????? 1,1,3,1,3,1
# ??#???.?##? 5,3
# ??##?#????##?###?? 5,6
# ???????##????#..?. 1,3,4,1,1,1
# ?##??#???.?#?? 3,1,1,2
# ?.???#?#???#?.????? 10,1,1
# ?#????..???????#??## 2,1,12
# ?.????#?#? 1,6
# ????#??#.#???..#???? 3,1,1,1,2,2
# ?#??????.???#?.? 1,4,1,1,1
# ?.#???##???????#. 1,2,2,7
# ....????????????? 3,5
# ??.?#?##????????.??? 1,2,4,1,1,2
# ??#?.##?#.?.? 2,4,1
# ?????#.??#?? 1,3,3
# ???#.??##?? 1,1,3
# ?.?????##?? 1,1,6
# ???#???#?# 3,1,1
# ???????####????##? 4,12
# ??#?.??.#.??##???.. 1,1,1,1,6
# .?..?.####??. 1,6
# ?#.???????? 1,2,2
# .??.????.#?.. 1,1,1,2
# ???#?????. 2,1
# .??#?#?.??#? 3,1,1
# ?????????#. 1,2
# ????.#?#????????? 1,1,1,8
# ??.??????#??..#????? 7,2
# ???#??##???# 2,1,4,1
# ?#?.?..???#??##?#??? 2,11
# ?.???#?#?? 1,3,1
# #?#?#??.#?.?.??.?#?? 1,1,3,2,1,2
# ?.??????#??? 2,1,4
# ???.#?#??? 1,1,2
# ??#????.??.???? 2,1,1,3
# ???.???#?????? 1,1,7
# ?????.?.?.## 1,1,2
# .?##.#?????????#? 3,5,1
# .???.????? 3,3
# ??#????.?????? 3,1,1,2
# ???#?####?#?#??#?.# 13,1
# ???#??#??#?.#?? 1,1,1,2,2
# .?.?.??.?? 1,1,1
# ?.?.?#####???##?? 1,12
# ##.???##?.?#?##??#? 2,1,2,8
# ????.?#??#??.#?? 4,2,3,1
# ###.???.?.?# 3,2,2
# .????#.???#??..?. 2,1
# ????????.?#?.? 1,4,2
# ?#??#??????? 5,4
# #???#.????##????##?? 2,1,14
# ??????.????#?. 2,1,1,4
# ????..#..?? 2,1
# .????..#???#? 1,6
# ??#????????#????..?? 1,1,10,1
# ??#..???.?? 1,3,1
# ??.?????.?#?#?. 1,3,5
# ?#???#???#?.. 7,3
# ?#?####???#???.?# 1,8,1,2
# ????#?#.#??#???#?.?? 1,1,1,5,2,1
# ????####???# 1,5,2
# ?.???#???? 3,1,1
# ?#?#??#???#??? 4,3,2
# ????#???#.??#???#??# 1,1,5,4,2,1
# #?.##.??????#.?????. 1,2,1,4,3
# #??????????#####??.? 1,1,3,7,1
# .##???##??.?. 2,5
# .???#####?? 1,5,1
# ??#.????#?????? 3,9
# .????.??.???.?. 3,1,3
# ?.#..????#?##????#? 1,1,6,2
# .?#?#.#?###????#. 1,1,8,1
# ???????#?.? 2,3
# ????.????###?#??? 1,1,2,6,1
# ????#???.???.???. 5,2
# ?#.???#..??#? 1,3,2
# ??.?##????? 1,3,1
# ?.?.??#?#?###? 1,7
# ?.?..##?#?????? 1,1,5,1
# ?#.??.????#.?.#???#? 1,1,5,6
# ???##??????? 1,3,1,1
# ??#???????#??? 1,4,4
# ????.?????#??? 3,7
# ?#.#????#?.?#. 2,2,3,2
# #??#?.#????? 5,2,2
# ?.#???????#?.?? 1,10
# ???#??????#?.?????? 4,3
# ????.?#?#?????????# 1,1,6,5,1
# ?#???#????#?#? 2,4,1,1
# ?#.?????#????#???? 1,15
# ?????#???.? 3,1
# ????#?#??????? 7,5
# ?.?.?.?#.??.?#???. 1,1,1,1,1,5
# .????#?#?????#?? 1,7
# ???#?##??#????.?? 7,1,1,1
# ???#???????.?.? 4,3,1,1
# ????????##??? 1,8
# #?????##???.???### 5,2,1,2,3
# ??#?????.? 2,1
# #???#?##?#?#????.? 3,4,1,1,2,1
# ##?.???###????#?? 3,2,3,4
# #?#?#????#???.#?? 1,10,1
# ?.#????#?.?#??? 6,2
# .?.???????#..????? 1,3,2,2
# ?.????##?#????? 1,7
# ??#??..?###?????# 2,4,4
# ???#???..#?##?.?. 3,4
# ##???#.???..???. 4,1,1,1,1
# ?????##??#?????? 1,11
# #??.??#???? 1,4,1
# ?.???#?####?#??????. 1,7,6
# ??#.????### 1,1,6
# .???#????.???#? 2,4,1,2
# ?#??..?#???##?#??.# 3,1,3,1,1,1
# .??#?#???????? 3,4
# .??#?#?#?????? 7,1,1
# ??##?.?..#??????. 2,1,4,2
# ?#???#..????#?.?? 6,2,2,1
# ??#??#??????# 5,1,1
# .??????###??#?????. 1,1,10
# ???????###.#????.? 8,4,1
# ??#???.#?#.#?? 3,3,3
# ??#..?#?????#??? 1,2,7
# .??#???.?#??? 3,1,1,1
# ??#????????#?? 6,1,2
# ????#???##?.??#? 1,7,1
# .??.?.???#??####? 1,1,10
# .????..?##?#? 4,5
# ??????.??#.? 1,1,3
# ??.??#.???????? 1,1,2,1,1
# ???#??...?????. 1,3,1,2
# ##??##????#?????? 2,4,4,1
# ?#??????..?. 3,1
# ?######??.??.#????. 8,1,3,1
# #???.???????#.??? 4,1,3,1,1
# ?#????#?#???#? 2,2,1,2
# ???.?????? 1,1,1
# .?##?#????#?.? 6,2
# ????#???#?##..???#? 1,5,1,2,1,3
# ???#.??#???????. 1,1,3,2,1
# ??..?.??#?.??????. 1,1,4,1,2
# ?#???????##??##???#? 4,1,12
# ...##???#?.???#. 7,1
# ?#.????????????. 2,1,3,1
# ??#?????..?##?? 1,2,3
# #????#?#?.???#?? 8,1,2,1
# .????????#????.??#?? 7,4
# ???#?##?????# 1,6,3
# ??#..#.??#??..? 3,1,5,1
# ????###???#??.??? 6,2,2
# ?.?????##????# 1,1,1,7
# ????.??.??#????? 4,6
# .?##?????#...??? 9,1
# ??.??##?.?#?? 1,3,1,1
# ?#..?????? 1,2
# ?##?????#? 5,1
# .####?.???? 4,2
# ????#?.#.?????? 5,1,1
# ???#???.#??????#?#?? 1,3,2,6
# .?..????.?????# 1,2,1,2
# ?#??.#?#?#?? 1,1,1,4
# ?#????#?????? 4,2,1,2
# ??#?#??#?#?# 2,1,6
# #??.#.#????..?#?? 1,1,5,2,1
# ?.??##????? 1,4,1
# ??????#????????#??? 2,1,6,1,1,2
# ??????#.????????#? 2,1,1,1,3,1
# ??????.???? 1,2,4
# ??##?#????????????.? 4,1,3,1,2,1
# ##??#??????????# 6,2,2,2
# ..???..??. 3,1
# ##?#?#?#??.#.????? 10,1,1
# #???.???.#??????. 3,2,4,1
# #.?.?#??????????.? 1,1,5,1,2,1
# ??#??#?????#.?.? 6,1,2,1
# .#?.????????#? 2,4,4
# .#?#?????.??. 4,2
# ?.#????.?.? 1,1,1
# .?#??.??.??? 2,1,2
# .??#.?????.. 1,1,1,1
# ?????#?#?#?##?? 2,3,1,4
# ??#??#?.#??#?#? 2,3,4,1
# ???????#????##?#?#. 4,1,1,8
# ???#????#??.#. 4,2,1,1
# ??#???.???. 3,2,1
# ????????????#?? 1,1,1,1,4
# ??#?#???.?.?.?? 1,1,4,1,1
# .?????.??.##?#??#?. 3,8
# ?.???.???. 2,3
# ?#???#?.???#??.#... 6,6,1
# .#.???#?##?## 1,4,2
# .????.??#?????# 4,8
# #??#???.??#?#? 2,1,1,6
# ?..????#????????# 1,1,6,1
# ?.??#??.???#?????#.. 1,5,4,1,3
# ..??????.????#??#. 4,7
# .???.??????. 2,4
# ???#..??#???? 4,6
# ?##.?.?#??#???? 3,1,1,2,3
# ?.##?????.?? 1,3,2,1
# .??.???#?.???..?? 2,5,2,2
# #???????.?? 8,1
# .??##?.???? 2,1
# ????####?#??.???#??? 1,4,1,1,4
# ??#..??????#? 1,1,2,2
# ?.?###?#?? 6,1
# .#??????#???.?.? 4,1,1,1,1
# ?..#??????.#? 1,1,4,1
# .?????????.? 4,1
# ???.??.?#??????? 3,1,1,3,1
# ?#??#??#???. 2,5,1
# ..???##???????? 8,2
# ??#?.#?????#??.# 1,4,2,1,1
# #.#.#.??#?##??#? 1,1,1,4,2
# .??#??#??? 1,1,2
# #??#??..?#.????. 2,3,2,1,1
# ???.????#? 1,1,1
# .?.?#???????? 1,7
# ??#.?????#?? 1,8
# ??.?????????#?? 1,1,8,1
# ?#??#??.?#?#?#???# 1,2,1,1,5,1
# ?#???#??#?#????.? 2,3,1,5,1
# ?????#.???# 2,2,3
# .?.????????#??#? 1,4,4
# ?????#?????#??#??.# 16,1
# ?#???#???? 2,2,1
# ##?#???????##..??? 13,1,1
# #?##?#??????????..? 6,1,1,1,1,1
# ?????.#?.??????#?#?? 1,2,2,1,1,7
# ?.?#???#??????.? 6,4
# #.###??????.? 1,3,1,1
# ????#??#..?#?#??? 6,5
# ?#????.??# 3,1,3
# .?????.??#????#??? 3,1,3,3
# #????.?#??#. 4,2,2
# ?????##.##??.?? 6,4,1
# #???????#????#????? 1,1,2,4,1,1
# ..???##?#?????##???? 1,15
# ?#..?#??.??.?..??# 2,4,1,1,1
# .????.?.?##? 2,1,3
# ?.????????#? 1,1,1,1
# .?.??#?#?????.???? 1,7,1,1
# #.???.???##?# 1,2,7
# #.?#???????? 1,2,2,1
# ??..#????????# 2,4,3
# ?#?#?????..?#??. 5,3,3
# ?.???????.????? 5,3
# .???.?#?#??#?#?###?? 2,1,1,4,3
# #???.????#??? 1,1,1,2
# ?????.???#? 1,3
# ?????##????##????#?. 6,8
# #?.??###??.#??. 2,5,3
# ?..?????????# 1,8,1
# ??##?#?#??????? 8,1,3
# ???.????#??.??? 1,2,3,2
# ?#?#.??...???#? 1,1,1,1,2
# ??#..#???.?????#? 1,4,4,1
# ???#?????#??.??? 7,2,3
# ??#????#???#.? 1,1,7,1
# ?#?#??????.????? 7,2
# ??????????. 2,1
# ?.??.???.??#.??#? 1,1,2,3,2
# ?#??.#.?#???#?.? 3,1,2,4,1
# ?#?#??#??.??? 7,1
# ##??##???.#???#? 2,5,1,1
# .????????? 2,1
# ???#??#????????.?. 1,1,4,1,2,1
# ????????#?...????.? 3,3
# ?..??.#??.?????.?#? 1,1,1,1,5,3
# ??#???#?#???????#? 3,11
# #???????#?###????.?? 6,9
# ???.#???.?#??? 1,4,4
# .????????.###??##?? 1,1,3,9
# ?#?.??.?..??.#?? 2,2,1,2,2
# #?###?????##?.#. 7,3,1
# ???.#?.?##?#?.???#?? 1,1,1,5,1,1
# ..?#????#?#?##?????? 3,11
# ?.???#????..????#?? 1,7,5
# ??..???#??#?#? 1,1,4,1
# ???#?.?#?#???#.??## 1,2,2,5,4
# #??.??.?.??#.?#?.? 2,2,1,2,1,1
# ??#?#?#..????. 5,3
# ?#???##??##.? 2,8
# ??#?.#????? 2,1,1
# ?#????.?????#???? 3,2,3
# ??.??##???.#???. 2,4,3
# ???###????.???#?.#? 1,5,1,4,2
# ??#?.?????. 3,1
# ???.??.???? 3,2
# .?##???#??##??..?. 7,5,1
# ????????#?.? 1,6
# #??#.?#?#??? 1,1,6
# .????##??.#?# 6,3
# #???#?#??#???..?.#?. 1,10,1,2
# ..???????###??#? 1,1,1,3,3
# ????#???.?? 7,1
# .??????.???####????? 1,1,1,1,7
# ?????????# 1,4,1
# ???.??????#??.??.??? 3,7,1,1,2
# .???#?##?.#?????#?? 7,9
# #????????#?.??##. 6,4,3
# .???.?????? 3,4
# .????##?##????#? 1,9,2
# ??##???..#?#?#????. 6,9
# ???#.???##??? 3,6,1
# #..???????????#??# 1,1,5,6
# ????.?#??#?.?? 1,5,1
# #???##???.????????? 8,2,2
# ???#.##.?##??##????? 1,1,2,7,1,1
# ?..???#?#??.?#? 5,2
# ????..???#. 1,4
# #??????.??..??..??? 7,1,1,1,1
# ???#.?.???.??? 2,1,3,2
# ?????#???#??#.? 6,4
# #??#?.?#??#??#? 4,1,2,2
# ##?.???????# 2,1,1,1
# ##?#?.???#???#?????# 4,1,3,3,2,1
# ????#??.#??#??###?? 1,1,1,1,1,6
# ?????#???? 1,1,5
# ?.?###??#??.?????. 9,3,1
# ?.#???.#?????????? 1,1,4,1,1,1
# .#####????.?? 5,1
# ...#...?..?. 1,1
# ?????.#.??#.?## 4,1,1,1,3
# #..??#??#.??.?? 1,3,1,1,2
# ??.?.?#????.??#?? 1,1,2,1,3
# ??.??.??.??..#? 1,1,2,2,2
# ?#???##?#?# 1,6
# ???##???.#??#?# 6,1,1,1,1
# #.???.#?##..?? 1,1,4,1
# #????##???##?##?#. 1,4,7
# ?#??????#?.?.#?#??? 6,2,1,4,1
# ..#?#???.?..# 1,2,1,1
# ????##???.?????.. 4,2,1
# .?#???#??.? 1,1
# .#?#?????.? 1,1,2
# #????#?.#?.??#? 1,2,1,2,1
# #.?#.?#????.#?# 1,2,5,1,1
# ?#?.?.#?#?#?? 2,6
# #..?.#???#??.#. 1,1,3,1,1
# #?...??#????#??????# 2,10,1,1
# .??..?##.??? 2,2,1
# .#??..??????????#??? 3,2,6,1,2
# """.strip().splitlines()
